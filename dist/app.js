!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.lazyload=function(e){var t=[].slice.call(e||document.querySelectorAll(".lazyload")),n=(i=function(){if(0===t.length)return window.removeEventListener("scroll",n);(t=t.filter(function(e){return e.classList.contains("lazyload")})).forEach(function(e){(function(e){var t=e.getBoundingClientRect(),n=t.top,i=t.left,r=t.right,s=t.bottom,a=document.documentElement.clientWidth,o=document.documentElement.clientHeight;return(n>0&&n<o||s>0&&s<o)&&(i>0&&i<a||r>0&&r<a)})(e)&&function(e){var t=new Image;t.src=e.dataset.src,t.onload=function(){e.src=t.src,e.classList.remove("lazyload")}}(e)})},r=500,function e(){var t=Date.now(),n=t-s;!s||n>=r?(i(),s=t):n<r&&(clearTimeout(a),a=setTimeout(e,r-n))});var i,r,s,a;window.addEventListener("scroll",n),window.dispatchEvent(new Event("scroll"))}},function(e,t,n){"use strict";n(2);var i=n(3),r=n(5),s=n(6),a=n(7),o=(new i.Recommend(document.querySelector("#recommend-view")),new r.Toplist(document.querySelector("#rank-view")),new s.Search(document.querySelector("#search-view")),new a.MusicPlayer(document.querySelector("#player-panel")));function c(){var e=location.hash;if(/^#player-panel\?.+/.test(e)){var t=e.slice(e.indexOf("?")+1).match(/(\w+)=([^&]+)/g),n=t&&t.reduce(function(e,t){var n=t.split("=");return e[n[0]]=decodeURIComponent(n[1]),e},{});o.play(n)}else o.hide()}document.querySelector("#header .player-btn").addEventListener("click",function(){o.show()}),c(),window.addEventListener("hashchange",c)},function(e,t,n){"use strict";var i=!1;document.querySelector(".navbar").addEventListener("click",function(e){if("li"===e.target.nodeName.toLowerCase()){var t=e.target;t.getAttribute("class")||(i=!0),[].forEach.call(t.parentElement.children,function(e){e.classList.remove("current")}),t.classList.add("current");var n=document.querySelector(t.dataset.view);n&&([].forEach.call(n.parentElement.children,function(e){e.classList.remove("active")}),n.classList.add("active"))}}),setInterval(function(){i&&(console.log("tab changed..."),window.dispatchEvent(new Event("scroll")),i=!1)},100)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Recommend=void 0;var i=n(4),r=n(0);function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.launch()}var t,n,a;return t=e,(n=[{key:"launch",value:function(){var e=this;fetch("https://qq-music-api.now.sh").then(function(e){return e.json()}).then(function(t){return e.json=t}).then(function(){return e.renderRecm()})}},{key:"renderRecm",value:function(){this.renderSlider(this.json.data.slider),this.renderRadio(this.json.data.radioList),this.renderHotSong(this.json.data.songList),(0,r.lazyload)(this.$el.querySelectorAll(".lazyload"))}},{key:"renderSlider",value:function(e){this.slider=new i.Slider({el:this.$el.querySelector(".qq-slider"),slideItems:e.map(function(e){return{link:e.linkUrl,img:e.picUrl}})})}},{key:"renderRadio",value:function(e){this.$el.querySelector(".radio .list-container").innerHTML=e.map(function(e){return'<li class="list-item">\n      <a href="#">\n        <div class="item-media">\n          <img class="lazyload" src="images/static.jpg" data-src="'.concat(e.picUrl,'" alt="">\n          <span class="icon"></span>\n        </div>\n        <div class="item-info">\n          <h3>').concat(e.Ftitle,"</h3>\n        </div>\n      </a>\n    </li>")}).join("")}},{key:"renderHotSong",value:function(e){this.$el.querySelector(".hot-song .list-container").innerHTML=e.map(function(e){return'<li class="list-item">\n      <a href="#">\n        <div class="item-media">\n          <img class="lazyload" src="images/static.jpg" data-src="'.concat(e.picUrl,'" alt="">\n          <span class="icon"></span>\n        </div>\n        <div class="item-info">\n          <h3>').concat(e.songListDesc,"</h3>\n        </div>\n      </a>\n    </li>")}).join("")}}])&&s(t.prototype,n),a&&s(t,a),e}();t.Recommend=a},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Slider=void 0;var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t.el,this.slideItems=t.slideItems,this.interval=t.interval||3e3,this.duration=t.duration||300,this.index=0,this.render(),this.start()}var t,n,r;return t=e,(n=[{key:"render",value:function(){this.$el.innerHTML='<div class="qq-slider-wrap"></div>',this.$wrap=this.$el.firstElementChild,this.$wrap.style.transitionDuration="".concat(this.duration,"ms"),this.$wrap.style.width="".concat(100*this.slideItems.length,"%"),this.$wrap.innerHTML=this.slideItems.map(function(e){return'<div class="qq-slider-item">\n      <a href="'.concat(e.link,'">\n        <img src="').concat(e.img,'" alt="">\n      </a>\n    </div>')}).join("")}},{key:"start",value:function(){setInterval(this.next.bind(this),this.interval)}},{key:"next",value:function(){this.index+=1,this.index===this.slideItems.length&&(this.index=0);var e="-".concat(100*this.index/this.slideItems.length,"%");this.$wrap.style.transform="translateX(".concat(e,")")}}])&&i(t.prototype,n),r&&i(t,r),e}();t.Slider=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Toplist=void 0;var i=n(0);function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.launch()}var t,n,s;return t=e,(n=[{key:"launch",value:function(){var e=this;fetch("https://qq-music-api.now.sh/top").then(function(e){return e.json()}).then(function(t){return e.list=t.data.topList}).then(function(){return e.renderRank()})}},{key:"renderRank",value:function(){var e=this;this.$el.querySelector(".top-list-wrap").innerHTML=this.list.map(function(t){return'<li class="top-item">\n      <a href="#">\n        <div class="item-img"><img class="lazyload" src="images/static.jpg" data-src="'.concat(t.picUrl,'" alt=""></div>\n        <div class="item-content">\n          <div class="topic ellipsis">').concat(t.topTitle,"</div>\n          ").concat(e.createSongList(t.songList),'\n          <i class="topic-arrow">></i>\n        </div>\n      </a>\n    </li>')}).join(""),(0,i.lazyload)(this.$el.querySelectorAll(".lazyload"))}},{key:"createSongList",value:function(e){return e.map(function(e,t){return'<div class="song-detail ellipsis">'.concat(t+1,'\n      <span class="song-name">').concat(e.songname,"</span>- ").concat(e.singername,"</div>")}).join("")}}])&&r(t.prototype,n),s&&r(t,s),e}();t.Toplist=s},function(e,t,n){"use strict";function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}Object.defineProperty(t,"__esModule",{value:!0}),t.Search=void 0;var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=t,this.$input=this.$el.querySelector("#search"),this.$btn=this.$el.querySelector(".search-btn"),this.$songs=this.$el.querySelector(".search-song-list"),this.keyword="",this.page=1,this.perpage=20,this.songs={},this.nomore=!1,this.fetching=!1,this.getTotalNum=0,this.$input.addEventListener("keyup",this.onKeyUp.bind(this)),this.$btn.addEventListener("click",this.onClick.bind(this)),this.onscroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onscroll)}var t,n,r;return t=e,(n=[{key:"onKeyUp",value:function(e){e.target.value.trim()||this.reset()}},{key:"onClick",value:function(e){var t=this.$input.value.trim();if(!t)return this.reset();this.search(t)}},{key:"search",value:function(e,t){var n=this;""!==e&&(this.keyword===e&&this.songs[t||this.page]||this.fetching||(this.keyword!==e&&this.reset(),this.keyword=e,this.loading(),fetch("https://qq-music-api.now.sh/search?keyword=".concat(this.keyword,"&page=").concat(t||this.page)).then(function(e){return e.json()}).then(function(e){return n.page=e.data.song.curpage,n.getTotalNum+=e.data.song.curnum,n.nomore=n.getTotalNum===e.data.song.totalnum,n.songs[n.page]=e.data.song.list,e.data.song.list}).then(function(e){return n.append(e)}).then(function(){return n.done()}).catch(function(){return n.fetching=!1})))}},{key:"append",value:function(e){this.$songs.innerHTML+=e.map(function(e){var t=e.singer.map(function(e){return e.name}).join("、");return'<li>\n        <a href="#player-panel?artist='.concat(t,"&songid=").concat(e.songid,"&songname=").concat(e.songname,"&albummid=").concat(e.albummid,"&duration=").concat(e.interval,'">\n          <i class="icon-music"></i>\n          <h6 class="main-title ellipsis">').concat(e.songname,'</h6>\n          <p class="sub-title ellipsis">').concat(t,"</p>\n        </a>\n      </li>")}).join("")}},{key:"onScroll",value:function(){this.nomore||document.documentElement.clientHeight+pageYOffset>document.body.scrollHeight-50&&this.search(this.keyword,this.page+1)}},{key:"reset",value:function(){this.page=1,this.keyword="",this.songs={},this.getTotalNum=0,this.$songs.innerHTML="",this.nomore=!1,this.$el.querySelector(".load-done").classList.add("hide")}},{key:"loading",value:function(){this.fetching=!0,console.log("show loading...."),this.$el.querySelector(".search-loading").classList.add("show")}},{key:"done",value:function(){this.fetching=!1,this.nomore?(this.$el.querySelector(".icon-loading").style.display="none",this.$el.querySelector(".loading").style.display="none",this.$el.querySelector(".load-done").classList.remove("hide"),this.$el.querySelector(".search-loading").classList.add("show")):this.$el.querySelector(".search-loading").classList.remove("show")}}])&&i(t.prototype,n),r&&i(t,r),e}();t.Search=r},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}Object.defineProperty(t,"__esModule",{value:!0}),t.MusicPlayer=void 0;var a=function(){function e(t){i(this,e),this.$el=t,this.$play=this.$el.querySelector(".panel-header .play"),this.$el.addEventListener("click",this),this.$audio=this.createAudio(),this.progressBar=new o(this.$el.querySelector(".player-footer .progress"),this.$audio),this.lyricsPlayer=new c(this.$el.querySelector(".lyric-box"),this.$audio),this.fetching=!1}return s(e,[{key:"createAudio",value:function(){var e=this,t=document.createElement("audio");return t.id="player-".concat(Math.floor(100*Math.random()),"-").concat(+new Date),t.addEventListener("ended",function(){e.lyricsPlayer.restart(),e.progressBar.restart()}),document.body.appendChild(t),t}},{key:"handleEvent",value:function(e){var t=event.target;switch(!0){case t.matches(".icon-play"):this.onPlay(t);break;case t.matches(".icon-pause"):this.onPause(t);break;case t.matches(".icon-list"):this.hide()}}},{key:"onPlay",value:function(e){this.fetching||alert("暂时无法播放,请点击列表图标隐藏播放界面")}},{key:"onPause",value:function(e){e.classList.toggle("icon-pause"),e.classList.toggle("icon-play"),this.progressBar.stop(),this.lyricsPlayer.stop()}},{key:"play",value:function(e){var t=this;if(e){this.$el.querySelector(".play-title .name").innerText=e.songname,this.$el.querySelector(".play-title .author").innerText=e.artist,this.progressBar.reset(e.duration);var n="https://y.gtimg.cn/music/photo_new/T002R150x150M000".concat(e.albummid,".jpg");this.$el.querySelector(".album-cover").src=n,this.$el.querySelector(".bg-cover").style.backgroundImage="url(".concat(n,")"),e.songid&&(this.songid!==e.songid&&(this.$play.classList.add("icon-play"),this.$play.classList.remove("icon-pause")),this.songid=e.songid,this.fetching=!0,fetch("https://qq-music-api.now.sh/lyrics?id=".concat(this.songid)).then(function(e){return e.json()}).then(function(e){return e.lyric}).then(function(e){return t.lyricsPlayer.reset(e)}).catch(function(){}).then(function(){return t.fetching=!1})),this.show()}}},{key:"show",value:function(){this.$el.classList.add("show"),document.body.classList.add("noscroll")}},{key:"hide",value:function(){this.$el.classList.remove("show"),document.body.classList.remove("noscroll")}}]),e}();t.MusicPlayer=a;var o=function(){function e(t,n,r,s){i(this,e),this.$el=t,this.$audio=n,this.duration=r||0,this.progress=0,this.currentTime=0,this.$currentTime=this.$el.querySelector(".current-time"),this.$totalTime=this.$el.querySelector(".total-time"),this.$totalBar=this.$el.querySelector(".bar"),this.$progressBar=this.$el.querySelector(".progress-now"),this.$currentTime.innerText=this.formatTime(this.currentTime),this.$totalTime.innerText=this.formatTime(this.duration),s&&this.start()}return s(e,[{key:"start",value:function(){this.stop(),this.intervalId=setInterval(this.update.bind(this),50)}},{key:"stop",value:function(){clearInterval(this.intervalId)}},{key:"update",value:function(){this.currentTime=Math.round(this.$audio?this.$audio.currentTime:this.currentTime+.05),this.currentTime>this.duration&&this.reset(),this.progress=this.currentTime/this.duration,this.$progressBar.style.transform="translateX(".concat(100*this.progress-100,"%)"),this.$currentTime.innerText=this.formatTime(this.currentTime)}},{key:"reset",value:function(e){this.stop(),this.currentTime=0,this.progress=0,this.$progressBar.style.transform="translateX(-100%)",this.$currentTime.innerText=this.formatTime(this.currentTime),e&&(this.duration=parseInt(e,10),this.$totalTime.innerText=this.formatTime(this.duration))}},{key:"restart",value:function(){this.reset(),this.start()}},{key:"formatTime",value:function(e){var t=""+Math.floor(e/60),n=""+Math.floor(e%60);return(t=1===t.length?"0"+t:t)+":"+(n=1===n.length?"0"+n:n)}}]),e}(),c=function(){function e(t,n){i(this,e),this.$el=t,this.$el.innerHTML='<div class="player-lyrics-lines"></div>',this.$lines=this.$el.querySelector(".player-lyrics-lines"),this.$audio=n,this.text="",this.lyricsArr=[],this.currentTime=0,this.index=0,this.reset(this.text)}return s(e,[{key:"renderLyrics",value:function(e){var t=[];e.split("\n").forEach(function(e){var n=e.match(/\d{2}:\d{2}/g),i=e.replace(/\[.+?\]/g,"");Array.isArray(n)&&""!=i&&n.forEach(function(e){t.push({time:e,value:i})})}),t.sort(this.byField("time")),this.lyricsArr=t,t.length&&(this.$lines.innerHTML=t.map(function(e,t){return'\n      <div class="player-lyric line-'.concat(t+1,'">').concat(e.value,"</div>")}).join(""))}},{key:"reset",value:function(e){this.stop(),this.index=0,this.currentTime=0,this.$lines.style.transform="translateY(0)";var t=this.$lines.querySelector(".active");t&&t.classList.remove("active"),e&&(this.text=this.formatText(e)||"",this.renderLyrics(this.text)),this.lyricsArr.length&&this.$lines.children[this.index].classList.add("active")}},{key:"start",value:function(){this.stop(),this.intervalId=setInterval(this.update.bind(this),1e3)}},{key:"stop",value:function(){clearInterval(this.intervalId)}},{key:"update",value:function(){if(this.currentTime=Math.round(this.$audio?this.$audio.currentTime:this.currentTime+1),this.index===this.lyricsArr.length-1)return this.reset();for(var e=this.index+1;e<this.lyricsArr.length;e++){var t=this.getSeconds(this.lyricsArr[e].time);if(this.currentTime==t&&(!this.lyricsArr[e+1]||this.currentTime<this.getSeconds(this.lyricsArr[e+1].time))){this.$lines.children[this.index].classList.remove("active"),this.$lines.children[e].classList.add("active"),this.index=e;break}}if(this.index>2){var n=-(this.index-2)*this.LINE_HEIGHT;this.$lines.style.transform="translateY(".concat(n,"px)")}}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"getSeconds",value:function(e){return e.replace(/(\d{2}):(\d{2})/,function(e,t,n){return 60*parseInt(t,10)+parseInt(n,10)})}},{key:"formatText",value:function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText}},{key:"byField",value:function(e){return function(t,n){return t[e]>n[e]?1:-1}}}]),e}();c.prototype.LINE_HEIGHT=30}]);